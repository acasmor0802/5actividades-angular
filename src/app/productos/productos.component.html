<div class="container">
  <h2>Gestor de Productos</h2>
  <p class="subtitle">Actividad 2: Formularios Reactivos</p>

  <form [formGroup]="productosForm" (ngSubmit)="onSubmit()">
    
    <!-- Campo Nombre del Producto -->
    <div class="form-group">
      <label for="nombre">Nombre del Producto:</label>
      <input 
        type="text" 
        id="nombre"
        formControlName="nombre"
        class="form-control"
        placeholder="Ej: Laptop HP">
      
      <div class="error" *ngIf="productosForm.get('nombre')?.invalid && productosForm.get('nombre')?.touched">
        <small *ngIf="productosForm.get('nombre')?.errors?.['required']">‚ö†Ô∏è Requerido</small>
        <small *ngIf="productosForm.get('nombre')?.errors?.['minlength']">‚ö†Ô∏è M√≠nimo 3 caracteres</small>
      </div>
    </div>

    <!-- Campo Descripci√≥n -->
    <div class="form-group">
      <label for="descripcion">Descripci√≥n:</label>
      <textarea 
        id="descripcion"
        formControlName="descripcion"
        rows="3"
        class="form-control"
        placeholder="Describe el producto..."></textarea>
      
      <div class="error" *ngIf="productosForm.get('descripcion')?.invalid && productosForm.get('descripcion')?.touched">
        <small *ngIf="productosForm.get('descripcion')?.errors?.['required']">‚ö†Ô∏è Requerido</small>
        <small *ngIf="productosForm.get('descripcion')?.errors?.['maxlength']">‚ö†Ô∏è M√°ximo 200 caracteres</small>
      </div>
    </div>

    <!-- Campo Precio -->
    <div class="form-group">
      <label for="precio">Precio (‚Ç¨):</label>
      <input 
        type="number" 
        id="precio"
        formControlName="precio"
        step="0.01"
        class="form-control"
        placeholder="0.00">
      
      <div class="error" *ngIf="productosForm.get('precio')?.invalid && productosForm.get('precio')?.touched">
        <small *ngIf="productosForm.get('precio')?.errors?.['required']">‚ö†Ô∏è Requerido</small>
        <small *ngIf="productosForm.get('precio')?.errors?.['min']">‚ö†Ô∏è Debe ser mayor a 0</small>
      </div>
    </div>

    <!-- Campo Cantidad -->
    <div class="form-group">
      <label for="cantidad">Cantidad:</label>
      <input 
        type="number" 
        id="cantidad"
        formControlName="cantidad"
        class="form-control"
        placeholder="1">
      
      <div class="error" *ngIf="productosForm.get('cantidad')?.invalid && productosForm.get('cantidad')?.touched">
        <small *ngIf="productosForm.get('cantidad')?.errors?.['required']">‚ö†Ô∏è Requerido</small>
        <small *ngIf="productosForm.get('cantidad')?.errors?.['min']">‚ö†Ô∏è M√≠nimo 1</small>
        <small *ngIf="productosForm.get('cantidad')?.errors?.['max']">‚ö†Ô∏è M√°ximo 1000</small>
      </div>
    </div>

    <!-- Campo Categor√≠a -->
    <div class="form-group">
      <label for="categoria">Categor√≠a:</label>
      <select 
        id="categoria"
        formControlName="categoria"
        class="form-control">
        <option value="">Seleccione una categor√≠a...</option>
        <option value="Electr√≥nica">Electr√≥nica</option>
        <option value="Ropa">Ropa</option>
        <option value="Alimentos">Alimentos</option>
        <option value="Hogar">Hogar</option>
        <option value="Deportes">Deportes</option>
        <option value="Libros">Libros</option>
      </select>
      
      <div class="error" *ngIf="productosForm.get('categoria')?.invalid && productosForm.get('categoria')?.touched">
        <small *ngIf="productosForm.get('categoria')?.errors?.['required']">‚ö†Ô∏è Requerido</small>
      </div>
    </div>

    <!-- Bot√≥n Submit -->
    <button 
      type="submit" 
      [disabled]="productosForm.invalid"
      class="btn-submit">
      Agregar Producto
    </button>
  </form>

  <!-- Lista de Productos -->
  <div class="productos-list" *ngIf="productos.length > 0">
    <h3>üì¶ Productos Ingresados ({{ productos.length }})</h3>
    
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Nombre</th>
          <th>Descripci√≥n</th>
          <th>Precio</th>
          <th>Cantidad</th>
          <th>Categor√≠a</th>
          <th>Subtotal</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let producto of productos">
          <td><strong>#{{ producto.id }}</strong></td>
          <td>{{ producto.nombre }}</td>
          <td>{{ producto.descripcion }}</td>
          <td>{{ producto.precio | currency:'EUR':'symbol':'1.2-2' }}</td>
          <td>{{ producto.cantidad }}</td>
          <td>
            <span class="categoria-badge">{{ producto.categoria }}</span>
          </td>
          <td>
            <strong>{{ (producto.precio * producto.cantidad) | currency:'EUR':'symbol':'1.2-2' }}</strong>
          </td>
          <td>
            <button 
              (click)="eliminarProducto(producto.id)" 
              class="btn-delete"
              title="Eliminar producto">
              Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="total">
        <strong>Total del Inventario: {{ calcularTotal() | currency:'EUR':'symbol':'1.2-2' }}</strong>
    </div>
  </div>

  <!-- Mensaje cuando no hay productos -->
  <div class="empty-state" *ngIf="productos.length === 0">
    <p>üì≠ No hay productos registrados a√∫n.</p>
    <p>¬°Agrega tu primer producto usando el formulario!</p>
  </div>
</div>